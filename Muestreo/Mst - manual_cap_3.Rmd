---
title: "MST. manual-cap3"
output: html_document
date: "2023-05-01"
---
#1. Tama√±o de muestra sin informaci√≥n previa.
Por medio de una encuesta desea conocerse la 
opini√≥n de las personas de 18 a√±os y m√°s sobre las medidas tomadas por el gobierno de 
‚ÄúTiquicia‚Äù para combatir el COVID 2.0. El muestreo a utilizar es mia y desea tenerse una idea de 
lo que est√° pensando la gente al respecto.

a. ¬øCu√°l f√≥rmula debe utilizarse para calcular el tama√±o de muestra?
b. ¬øQu√© valor tendr√°n los par√°metros de ùëõ0?
n0=(Za/2)^2 pq/d^2
za/2=1.96
p=0.5
q=(1-0.5)
alfa=0.05
p=0.5
d=0.05
```{r}
p=0.5
d=0.05
alfa=0.05
q=1-p
z=qnorm(1-alfa/2)

(x1=c(p,d,alfa,q,z))
```

c. Calcule ùëõ0.
```{r}
(n0=(z^2*p*q)/(d^2))
```

d. Si el tama√±o de la poblaci√≥n es de ùëÅ = 11308 ¬ødeber√≠a aplicarse la correcci√≥n por finitud?
```{r}
f=384.1459/11308
f>0.05
```
Dado que ùëì = 0.034 < 0.05, no requiere aplicarse la correcci√≥n por finitud.

#2. Tama√±o de muestra para una subclase con una variable dicot√≥mica.
Se va a realizar una 
encuesta en ‚ÄúTiquicia‚Äù usando mia y se requiere calcular el n√∫mero de viviendas (tama√±o de 
muestra) que deben seleccionarse para conocer, entre otros aspectos, la proporci√≥n de carros 
particulares manejados por personas menores de 35 a√±os.

a. ¬øPor qu√© se dice que se va a calcular el tama√±o de muestra para una subclase?
b. Lea el marco muestral marco3a y observe que mientras no se poseen datos de la variable de 
estudio, s√≠ existe informaci√≥n de las viviendas que poseen carros particulares (carro, con 
c√≥digo 0=no, 1=s√≠). Obtenga la proporci√≥n de viviendas que posee carro particular usando 
summary(), pues la variable es num√©rica.
```{r}
load("marco3a.Rdata")
prop_car=mean(marco3a$carro)
```
c. Debido a que se trata de una variable dicot√≥mica ¬øcu√°l f√≥rmula debe usarse para calcular el 
tama√±o de muestra?
n0=(Za/2)^2 pq/d^2
d. ¬øCu√°l es el valor de los par√°metros en ùëõ0?
```{r}
p=0.5
q=1-p
alfa=0.05
z=qnorm(1-alfa/2)
d=0.04
```

e. Calcule ùëõ0.
```{r}
(n0=(z^2*p*q)/(d^2))
```

f. Calcule ùëõ con la correcci√≥n por finitud.
```{r}
N= length(marco3a$carro)
f=n0/N
f>0.05
(n=(n0)/(1+n0/N))
```

g. ¬øCu√°ntas viviendas deben seleccionarse del marco para que produzca una muestra de 570 
viviendas con al menos un carro particular?
```{r}
n/prop_car
```

#3. Tama√±o de muestra para varias variables dicot√≥micas. 
Se requiere informaci√≥n 
actualizada sobre el uso de las tecnolog√≠as de informaci√≥n y comunicaci√≥n (TIC) en ‚ÄúTiquicia‚Äù. 
Por este motivo, se pide que calcule un tama√±o de muestra (n√∫mero de personas) para realizar 
una encuesta. Como informaci√≥n base se posee el marco muestral marco3a, que contiene datos 
actualizados de las viviendas particulares y sus residentes. Para calcular el n√∫mero de personas a 
entrevistar se aclar√≥ que, en lo referente a las TIC, interesa conocer sobre el uso que hacen las 
personas del celular, computadora de escritorio y port√°til, tableta e internet. Se desea saber, por 
ejemplo, tipo y cantidad de dispositivos que utiliza, tiempo de uso diario de cada uno de ellos, 
actividades que realiza, personas con las que se comunica, etc. El marco contiene informaci√≥n 
relacionada con el tema y espec√≠ficamente, para las personas jefes de hogar, se sabe si usaron o 
no estas tecnolog√≠as en los √∫ltimos 3 meses (las variables son celular3, portatil3, tablet3, 
compu3 e internet3, todas num√©ricas, con c√≥digos 0=no y 1=s√≠). Pese a que la informaci√≥n es 
referida √∫nicamente a la persona jefe de hogar, se toma como base para los c√°lculos, pues no se 
posee otra fuente reciente que brinde informaci√≥n para todas las personas de la vivienda. Siga las 
siguientes instrucciones para calcular el tama√±o de muestra.

a. Lea el archivo marco3a.
```{r}
load("marco3a.Rdata")
library(survey)
library(PracTools)
```

b. Debido a que las variables de estudio son dicot√≥micas ¬øcu√°l es la f√≥rmula que debe 
utilizarse para calcular el tama√±o de muestra?
n0=(Za/2)^2 pq/d^2
c. Obtenga una frecuencia simple de todos los dispositivos de estudio usando la funci√≥n 
summary(). Construya un gr√°fico que muestre el porcentaje de tenencia de cada dispositivo.
```{r}
attach(marco3a)
tab=summary(tablet3)*100
com=summary(compu3)*100
por=summary(portatil3)*100
int=summary(internet3)*100
cel=summary(celular3)*100
frec=round(c(tab[4], com[4], por[4], int[4], cel[4]),1)
names(frec)=c("Tablet","Computadora","Portatil","Internet","Celular")
frec
detach(marco3a)
```

d. ¬øC√≥mo se establece el valor de ùëù en este caso?

e. ¬øQu√© dicen las frecuencias obtenidas acerca del uso de los dispositivos? Decida c√≥mo 
proceder ùëù y calcule el tama√±o de muestra.
```{r}
```

f. Calcule el tama√±o de muestra. Asuma un mia, ùëù = 0.5, tres puntos porcentuales de error 
(ùëë = 0.03) y una confianza del 95% de que el valor real no supere a ùëë (riesgo del 5% de 
que el error real supere a ùëë)

```{r}
p=0.5
q=1-p
alfa=0.05
z=qnorm(1-alfa/2)
d=0.03

(n0=(z^2*p*q)/(d^2))

N= length(marco3a$region)
f=n0/N
f>0.05
(n=(n0)/(1+n0/N))
```
forma alternativa con la libreria 
library(PracTools)

```{r}
p=0.5
q=1-p
alfa=0.05
z=qnorm(1-alfa/2)
d=0.03

(n0=nProp(V0=(d/z)^2,pU=p))
(n=(n0)/(1+n0/N))
```

#5. Selecci√≥n de la muestra con mia.
De acuerdo con los c√°lculos anteriores, el tama√±o de 
muestra requerido es de 975 personas de 18 a√±os y m√°s, con un margen de error del 3%.

a. Seleccione la muestra de 975 viviendas (una persona por vivienda) usando mia, guarde el 
archivo con formato R usando save() y p√≥ngale como nombre muestra3a.Rdata. Asuma que 
esa muestra de 975 viviendas contiene la informaci√≥n recolectada en el trabajo de campo.
```{r}
set.seed(123)
muestra0 = sample(1:nrow(marco3a), size=975, replace=FALSE)
muestra3a = marco3a[muestra0,] 
muestra3a = na.omit(muestra3a)
save(muestra3a,file="muestra3a.Rdata")
```

b. Defina el dise√±o utilizado usando svydesign()para analizar posteriormente la informaci√≥n de 
la muestra seleccionada.
```{r}
(N=nrow(marco3a))
(n=nrow(muestra3a))
diseno=svydesign(id=~1,data = muestra3a,fpc =rep(N,n) )
```

c. Calcule los intervalos de confianza para el uso de tablet, computadora, port√°til, internet y 
celular en los √∫ltimos tres meses, para las personas jefes de hogar. Compare con los valores 
poblacionales y obtenga sus conclusiones. Visualice la informaci√≥n contruyendo un gr√°fico 
con los intervalos de confianza para cada dispositivo.
```{r}
mean(muestra3a$tablet3)
(tt=svymean(~muestra3a$tablet3,diseno))
(ca=svymean(~muestra3a$compu3,diseno))
(pl=svymean(~muestra3a$portatil3,diseno))
(it=svymean(~muestra3a$internet3,diseno))
(cr=svymean(~muestra3a$celular3,diseno))
confint(tt)
confint(ca)
confint(pl)
confint(it)
confint(cr)

```

d. Suponga que se quieren estimaciones para las TIC, con la misma precisi√≥n, en la zona 
urbana y rural. Obtenga de marco3a las proporciones de uso de los dispositivos en ambas 
zonas usando tapply() y analice la situaci√≥n. Construya un gr√°fico que muestre el uso de las 
TIC por zona. ¬øQu√© tama√±o de muestra deber√≠a seleccionarse para cumplir con este 
requerimiento?

```{r}
tapply(marco3a$tablet3,marco3a$zona,mean)
tapply(marco3a$compu3,marco3a$zona,mean)
tapply(marco3a$internet3,marco3a$zona,mean)
tapply(marco3a$portatil3,marco3a$zona,mean)
tapply(marco3a$celular3,marco3a$zona,mean)
```
#6. Tama√±o de muestra a partir del error est√°ndar deseado de ùëù.
Tomando como base lo 
hecho anteriormente, relacionado con el uso de las TIC, si se solicita que el error est√°ndar de ùëù
sea del 2% para todo el pa√≠s ¬øqu√© tama√±o de muestra deber√≠a seleccionarse?
```{r}
```

